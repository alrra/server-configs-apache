# ----------------------------------------------------------------------
# | Serving GZip pre-compressed content                                |
# ----------------------------------------------------------------------

<IfModule mod_headers.c>

    # Serve gzip compressed CSS, JS, HTML, SVG, ICS and JSON files if they exist
    # and the client accepts gzip.
    RewriteCond %{HTTP:Accept-Encoding} gzip
    RewriteCond %{REQUEST_FILENAME}\.gz -f
    RewriteRule \.(css|js|html|svg|ics|json)$ %{REQUEST_URI}.gz [L]

    # Serve correct content types, and prevent mod_deflate double gzip.
    RewriteRule "\.css\.gz$" "-" [T=text/css,E=no-gzip:1]
    RewriteRule "\.js\.gz$" "-" [T=text/javascript,E=no-gzip:1]
    RewriteRule "\.html\.gz$" "-" [T=text/html,E=no-gzip:1]
    RewriteRule "\.svg\.gz$" "-" [T=image/svg+xml,E=no-gzip:1]
    RewriteRule "\.ics\.gz$" "-" [T=text/calendar,E=no-gzip:1]
    RewriteRule "\.json\.gz$" "-" [T=text/json,E=no-gzip:1]

    <FilesMatch "\.gz$">
      # Force proxies to cache gzipped &
      # non-gzipped css/js files separately.
      Header append Vary Accept-Encoding
    </FilesMatch>

    # Serve correct encoding type.
    AddEncoding gzip .gz

</IfModule>
